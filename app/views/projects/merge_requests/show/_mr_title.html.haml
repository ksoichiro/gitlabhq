%h3.page-title
  = "マージリクエスト ##{@merge_request.iid}"

  %span.pull-right.issue-btn-group
    - if can?(current_user, :modify_merge_request, @merge_request)
      - if @merge_request.open?
        .btn-group.pull-left
          %a.btn.btn-grouped.dropdown-toggle{ data: {toggle: :dropdown} }
            %i.icon-download-alt
            ダウンロード
            %span.caret
          %ul.dropdown-menu
            %li= link_to "メール用パッチ", project_merge_request_path(@project, @merge_request, format: :patch)
            %li= link_to "プレーンDiff",    project_merge_request_path(@project, @merge_request, format: :diff)

        = link_to 'クローズ', project_merge_request_path(@project, @merge_request, merge_request: { state_event: :close }), method: :put, class: "btn btn-grouped btn-close", title: "マージリクエストをクローズ"

        = link_to edit_project_merge_request_path(@project, @merge_request), class: "btn btn-grouped", id:"edit_merge_request" do
          %i.icon-edit
          編集
      - if @merge_request.closed?
        = link_to '再オープン', project_merge_request_path(@project, @merge_request, merge_request: {state_event: :reopen }), method: :put, class: "btn btn-grouped btn-reopen reopen-mr-link", title: "マージリクエストをクローズ"

.votes-holder.hidden-sm.hidden-xs
  #votes= render 'votes/votes_block', votable: @merge_request

.back-link
  = link_to project_merge_requests_path(@project) do
    &larr; 一覧に戻る

  %span.prepend-left-20
    %span From
    - if @merge_request.for_fork?
      %strong.label-branch #{@merge_request.source_project_namespace}:#{@merge_request.source_branch}
      %span into
      %strong.label-branch #{@merge_request.target_project_namespace}:#{@merge_request.target_branch}
    - else
      %strong.label-branch #{@merge_request.source_branch}
      %span into
      %strong.label-branch #{@merge_request.target_branch}
