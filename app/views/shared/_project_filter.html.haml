.side-filters
  = form_tag project_entities_path, method: 'get' do
    - if current_user
      %fieldset
        %ul.nav.nav-pills.nav-stacked
          %li{class: ("active" if params[:scope] == 'all')}
            = link_to project_filter_path(scope: 'all') do
              すべて
              %span.pull-right
                = authorized_entities_count(current_user, entity, @project)
          %li{class: ("active" if params[:scope] == 'assigned-to-me')}
            = link_to project_filter_path(scope: 'assigned-to-me') do
              自分の課題
              %span.pull-right
                = assigned_entities_count(current_user, entity, @project)
          %li{class: ("active" if params[:scope] == 'created-by-me')}
            = link_to project_filter_path(scope: 'created-by-me') do
              自分が作成
              %span.pull-right
                = authored_entities_count(current_user, entity, @project)

    %fieldset
      %legend ステータス
      %ul.nav.nav-pills
        %li{class: ("active" if params[:state] == 'opened')}
          = link_to project_filter_path(state: 'opened') do
            オープン
        %li{class: ("active" if params[:state] == 'closed')}
          = link_to project_filter_path(state: 'closed') do
            解決
        %li{class: ("active" if params[:state] == 'all')}
          = link_to project_filter_path(state: 'all') do
            すべて

    - if defined?(labels)
      %fieldset
        %legend
          ラベル
          %small.pull-right
            = link_to project_labels_path(@project), class: 'light' do
              %i.icon-edit
        %ul.nav.nav-pills.nav-stacked.nav-small.labels-filter
          - @project.labels.order_by_name.each do |label|
            %li{class: label_filter_class(label.name)}
              = link_to labels_filter_path(label.name) do
                = render_colored_label(label)
                - if selected_label?(label.name)
                  .pull-right
                    %i.icon-remove

        - if @project.labels.empty?
          .light-well
            = link_to 'ラベルページ', project_labels_path(@project)
            に最初のラベルを作成
            %br
            または デフォルトのラベルセットを#{link_to '生成', generate_project_labels_path(@project, redirect: redirect), method: :post}

    %fieldset
      - if %w(state scope milestone_id assignee_id label_name).select { |k| params[k].present? }.any?
        = link_to project_entities_path, class: 'cgray pull-right' do
          %i.icon-remove
          %strong 絞り込みを解除


